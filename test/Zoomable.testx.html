<!DOCTYPE html>
<html>

<head>
    <title>Zoomable Component Test</title>
    <link href="/node_modules/@woby/chk/dist/index.css" rel="stylesheet">
    <script type="module" src="../src/Zoomable.tsx"></script>
    <script type="module" src="../src/Button.tsx"></script>
</head>

<body>
    <link href="../dist/wui.css" rel="stylesheet">
    <h2 class="text-[1.2em] pl-4 font-bold">Zoomable Component Test Suite</h2>

    <woby-chk name="Default Zoomable">
        <wui-zoomable snapshot-name="default-zoomable">
            <wui-zoomable-img src="https://picsum.photos/200/300" alt="Basic Image">
        </wui-zoomable>
    </woby-chk>

    <woby-chk name="Zoomable with Custom Scale">
        <wui-zoomable min-scale="0.5" max-scale="10" snapshot-name="custom-scale-zoomable">
            <wui-zoomable-img src="https://picsum.photos/300/200" alt="Custom Scale Image">
        </wui-zoomable>
    </woby-chk>

    <woby-chk name="Zoomable with Custom Size">
        <wui-zoomable width="500" height="400" snapshot-name="custom-size-zoomable">
            <wui-zoomable-img src="https://picsum.photos/400/300" alt="Custom Size Image">
        </wui-zoomable>
    </woby-chk>

    <woby-chk name="Styled Zoomable">
        <wui-zoomable cls="!border-2 !border-blue-500 rounded-xl shadow-lg" snapshot-name="styled-zoomable">
            <wui-zoomable-img src="https://picsum.photos/250/250" alt="Styled Image" class="rounded-lg">
        </wui-zoomable>
    </woby-chk>

    <woby-chk name="Controlled Zoomable">
        <div snapshot-name="controlled-zoomable">
            <div class="mb-4">
                <p class="text-gray-700 font-semibold my-2">Current Scale: <span id="scale-value"
                        class="font-mono bg-gray-100 px-1 py-2 rounded">1</span></p>
                <button class="bg-blue-500 text-white px-3 py-1 rounded mr-2" onclick="changeZoom(0.5)">
                    Zoom In
                </button>

                <button class="bg-green-500 text-white px-3 py-1 rounded" onclick="changeZoom(-0.5)">
                    Zoom Out
                </button>
            </div>

            <wui-zoomable id="my-zoomable" scale="1">
                <wui-zoomable-img src="https://picsum.photos/300/300" alt="Image"></wui-zoomable-img>
            </wui-zoomable>

        </div>
    </woby-chk>


    <script>
        function changeZoom(delta) {
            // 1. Find the element
            const element = document.getElementById('my-zoomable');

            // 2. Get current scale (default to 1 if missing)
            // Attributes are always strings, so we parse it to a Float
            let currentScale = parseFloat(element.getAttribute('scale') || "1");

            // 3. Calculate new scale
            let newScale = currentScale + delta;

            // 4. (Optional) Clamp limits manually in JS so buttons don't go crazy
            // Use the same min/max as your component
            const min = 1;
            const max = 5;
            if (newScale < min) newScale = min;
            if (newScale > max) newScale = max;

            // 5. Update the component
            // This triggers the observable inside Voby/Oby
            element.setAttribute('scale', newScale);

            document.getElementById('scale-value').textContent = newScale;
        }
    </script>
</body>

</html>